' Gambas class file


Create Static


''*********** INICIO UTILIDADES ****************
Static Public Function utilSplit(str As String, strSep As String, Optional notEnclosedIn As String[] = Null) As String[]
	Dim i As Integer, nTam As Integer, strAux As String, idxEnclosed As Integer = -1, strEnclosed As String = "", strChar As String
	Dim arrRet As New String[]
	
	If notEnclosedIn = Null Then
		arrRet = Split(str, strSep, "", True)
	Else
		nTam = Len(str)
		strAux = ""
		For i = 1 To nTam
			strChar = Mid$(str, i, 1)
			idxEnclosed = notEnclosedIn.Find(strChar)
			If strChar = strSep Then
				If Len(strEnclosed) = 0 Then
					arrRet.Add(strAux)
					strAux = ""
				Else
					strAux &= strChar
				Endif
			Else If Len(strEnclosed) = 0 And idxEnclosed > -1 Then
				strEnclosed = notEnclosedIn[idxEnclosed]
				strAux &= strChar
			Else If strEnclosed = strChar Then
				strEnclosed = ""
				idxEnclosed = -1
				strAux &= strChar
			Else
				strAux &= strChar
			Endif
		Next
	Endif
	
	If Not arrRet Or arrRet.Count = 0 Then
    arrRet.Add(str)
  Else If Len(strAux) > 0 Then
    arrRet.Add(strAux)
    strEnclosed = ""
    idxEnclosed = -1
    strAux = ""
  Endif
	
	Return arrRet
End

Static Public Function utilTrim(str As String, arrStrTrimed As String[]) As String
  Dim i As Integer, j As Integer, nTam As Integer
  Dim strAux As String = "", strRet As String = ""

  nTam = Len(str)
  If nTam = 0 Then Return str
  
  For i = 1 To nTam
    If arrStrTrimed.Find(Mid$(str, i, 1)) < 0 Then 	'Si se encuentra algun caracter que no hay que trimar ....
      strAux = Mid$(str, i)
      Break
    Endif
  Next

  nTam = Len(strAux)
  If nTam < 1 Then Return strAux
  For i = 0 To nTam
    If arrStrTrimed.Find(Mid$(strAux, nTam - i, 1)) < 0 Then 	'Si se encuentra algun caracter que no hay que trimar ....
      strRet = Mid$(strAux, 1, nTam - i)
      Break
    Endif
  Next
  Return strRet
End
''*********** FIN UTILIDADES ****************
