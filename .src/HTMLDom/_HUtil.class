' Gambas class file

Create Static


''*********** INICIO UTILIDADES ****************
Public Static Function utilSplit(str As String, strSep as String, Optional notEnclosedIn as String[]=Null) As String[]
	Dim i as Integer, nTam as Integer, straAux as String, idxEnclosed as Integer=-1, strEnclosed as String="", strChar as String
	Dim arrRet As String[]
	
	if notEnclosedIn=Null then
		arrRet=Split(str, strSep, "", True)
	else
		nTam=Len(str)
		strAux=""
		for i=1 to nTam
			strChar=Mid$(str, i, 1)
			if strChar=strSep then
				if Len(strEnclosed)=0 then
					arrRet.Add(strAux)
					strAux=""
				else
					strAux &=strChar
				EndIf
			else if Len(strEnclosed)=0 and (idxEnclosed=notEnclosedIn.Find(strChar))>-1 then
				strEnclosed=notEnclosedIn[idxEnclosed]
			else if strEnclosed = strChar then
				strEnclosed=""
				idxEnclosed=-1
			else
				strAux &=strChar
			EndIf
		next
	Endif
	
	Return arrRet
End

Public Static Function utilTrim(strEtiqueta As String, arrStrTrimed As String[]) As String
  Dim i As Integer, j As Integer, nTam As Integer
  Dim strAux As String = "", strRet As String = ""

  nTam = Len(strEtiqueta)

  For i = 1 To nTam
    If arrStrTrimed.Find(Mid$(strEtiqueta, i, 1)) < 0 Then 	'Si se encuentra algun caracter que no hay que trimar ....
      strAux = Mid$(strEtiqueta, i)
      Break
    Endif
  Next

  nTam = Len(strAux)
  For i = 0 To nTam
    If arrStrTrimed.Find(Mid$(strAux, nTam - i, 1)) < 0 Then 	'Si se encuentra algun caracter que no hay que trimar ....
      strRet = Mid$(strAux, 1, nTam - i)
      Break
    Endif
  Next
  Return strRet
End
''*********** FIN UTILIDADES ****************
